# API路由简化文档

## 概述

本文档描述了IPv6 WireGuard Manager项目中API路由的简化方案，旨在减少路由管理的复杂性，提高代码的可维护性。

## 简化前的问题

1. **路由配置分散**: 路由配置分散在多个文件中，难以统一管理
2. **路径定义复杂**: 路径定义使用了复杂的构建器和验证器
3. **版本控制过度**: 引入了过度复杂的版本控制机制
4. **代码重复**: 存在大量重复的路由定义代码

## 简化方案

### 1. 统一路由管理

使用简化的路由管理器，集中管理所有API端点：

```python
# 创建简化的路由管理器
router = SimpleAPIRouter()

# 注册模块
router.register_module("auth", "/auth", ".endpoints.auth", ["认证"])
router.register_module("users", "/users", ".endpoints.users", ["用户管理"])
```

### 2. 简化路径配置

使用简单的常量定义和函数构建路径：

```python
# 路径常量
AUTH_LOGIN = "/login"
USERS_LIST = ""

# 路径构建函数
def get_auth_path(action: str):
    return get_api_path("auth", action)
```

### 3. 移除过度复杂的版本控制

简化版本控制机制，专注于当前版本：

```python
# 简化的版本控制
API_BASE_PATH = "/api"
API_CURRENT_VERSION = "v1"
```

## 实施步骤

1. **分析现有路由配置**: 识别所有路由定义和配置
2. **创建简化管理器**: 实现简化的路由管理器
3. **重构路径定义**: 使用简单的常量和函数
4. **更新API文档**: 更新相关文档和示例

## 优势

1. **降低复杂性**: 减少了路由管理的复杂性
2. **提高可维护性**: 集中管理路由，易于维护
3. **减少代码重复**: 消除了重复的路由定义
4. **简化开发流程**: 开发者更容易理解和添加新路由

## 使用指南

### 添加新模块

1. 在路由管理器中注册模块
2. 创建对应的端点文件
3. 定义路径常量和函数

### 添加新端点

1. 在对应的端点文件中定义处理函数
2. 在路径配置中添加路径常量
3. 使用装饰器或直接注册端点

## 迁移指南

从复杂的路由配置迁移到简化版本：

1. 备份现有配置
2. 运行简化脚本
3. 测试所有API端点
4. 更新相关文档

## 最佳实践

1. 保持路由定义简单明了
2. 使用一致的命名规范
3. 定期审查和清理未使用的路由
4. 保持文档与代码同步
