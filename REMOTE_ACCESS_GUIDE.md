# è¿œç¨‹è®¿é—®ç«¯å£é…ç½®æŒ‡å—

## ğŸŒ æ¦‚è¿°

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•é…ç½®IPv6 WireGuard Managerçš„è¿œç¨‹è®¿é—®ç«¯å£ï¼ŒåŒ…æ‹¬é˜²ç«å¢™é…ç½®å’Œäº‘æœåŠ¡å•†å®‰å…¨ç»„è®¾ç½®ã€‚

## ğŸ”Œ éœ€è¦å¼€æ”¾çš„ç«¯å£

### å¿…éœ€ç«¯å£

| ç«¯å£ | åè®® | æœåŠ¡ | è¯´æ˜ |
|------|------|------|------|
| 80 | TCP | HTTP | å‰ç«¯Webç•Œé¢è®¿é—® |
| 443 | TCP | HTTPS | åŠ å¯†Webè®¿é—®ï¼ˆå¯é€‰ï¼‰ |
| 22 | TCP | SSH | æœåŠ¡å™¨ç®¡ç†è®¿é—® |

### å¯é€‰ç«¯å£

| ç«¯å£ | åè®® | æœåŠ¡ | è¯´æ˜ |
|------|------|------|------|
| 8000 | TCP | API | åç«¯APIç›´æ¥è®¿é—®ï¼ˆé€šå¸¸ä¸éœ€è¦ï¼‰ |

## ğŸš€ å¿«é€Ÿé…ç½®

### è‡ªåŠ¨é…ç½®è„šæœ¬

```bash
# ä¸‹è½½å¹¶è¿è¡Œè¿œç¨‹è®¿é—®é…ç½®è„šæœ¬
curl -fsSL https://raw.githubusercontent.com/ipzh/ipv6-wireguard-manager/main/configure-remote-access.sh | bash
```

### æ‰‹åŠ¨é…ç½®

#### 1. UFWé˜²ç«å¢™é…ç½®

```bash
# å®‰è£…UFWï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
sudo apt update
sudo apt install ufw

# å¼€æ”¾ç«¯å£
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 80/tcp    # HTTP
sudo ufw allow 443/tcp   # HTTPS

# å¯ç”¨é˜²ç«å¢™
sudo ufw enable

# æŸ¥çœ‹çŠ¶æ€
sudo ufw status
```

#### 2. Firewalldé˜²ç«å¢™é…ç½®

```bash
# å¼€æ”¾ç«¯å£
sudo firewall-cmd --permanent --add-service=ssh
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https

# é‡æ–°åŠ è½½é…ç½®
sudo firewall-cmd --reload

# æŸ¥çœ‹çŠ¶æ€
sudo firewall-cmd --list-all
```

#### 3. iptablesé˜²ç«å¢™é…ç½®

```bash
# æ·»åŠ è§„åˆ™
sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT

# ä¿å­˜è§„åˆ™
sudo iptables-save > /etc/iptables/rules.v4
```

## â˜ï¸ äº‘æœåŠ¡å•†å®‰å…¨ç»„é…ç½®

### AWS EC2

1. ç™»å½•AWSæ§åˆ¶å°
2. è¿›å…¥EC2æœåŠ¡
3. é€‰æ‹©"å®‰å…¨ç»„"
4. ç¼–è¾‘å…¥ç«™è§„åˆ™ï¼š
   - ç±»å‹ï¼šHTTPï¼Œç«¯å£ï¼š80ï¼Œæºï¼š0.0.0.0/0
   - ç±»å‹ï¼šHTTPSï¼Œç«¯å£ï¼š443ï¼Œæºï¼š0.0.0.0/0
   - ç±»å‹ï¼šSSHï¼Œç«¯å£ï¼š22ï¼Œæºï¼šæ‚¨çš„IP

### é˜¿é‡Œäº‘ECS

1. ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°
2. è¿›å…¥ECSæœåŠ¡
3. é€‰æ‹©"å®‰å…¨ç»„"
4. æ·»åŠ å…¥æ–¹å‘è§„åˆ™ï¼š
   - åè®®ç±»å‹ï¼šTCPï¼Œç«¯å£èŒƒå›´ï¼š80/80ï¼Œæˆæƒå¯¹è±¡ï¼š0.0.0.0/0
   - åè®®ç±»å‹ï¼šTCPï¼Œç«¯å£èŒƒå›´ï¼š443/443ï¼Œæˆæƒå¯¹è±¡ï¼š0.0.0.0/0
   - åè®®ç±»å‹ï¼šTCPï¼Œç«¯å£èŒƒå›´ï¼š22/22ï¼Œæˆæƒå¯¹è±¡ï¼šæ‚¨çš„IP

### è…¾è®¯äº‘CVM

1. ç™»å½•è…¾è®¯äº‘æ§åˆ¶å°
2. è¿›å…¥CVMæœåŠ¡
3. é€‰æ‹©"å®‰å…¨ç»„"
4. æ·»åŠ å…¥ç«™è§„åˆ™ï¼š
   - ç±»å‹ï¼šHTTPï¼Œç«¯å£ï¼š80ï¼Œæ¥æºï¼š0.0.0.0/0
   - ç±»å‹ï¼šHTTPSï¼Œç«¯å£ï¼š443ï¼Œæ¥æºï¼š0.0.0.0/0
   - ç±»å‹ï¼šSSHï¼Œç«¯å£ï¼š22ï¼Œæ¥æºï¼šæ‚¨çš„IP

### åä¸ºäº‘ECS

1. ç™»å½•åä¸ºäº‘æ§åˆ¶å°
2. è¿›å…¥ECSæœåŠ¡
3. é€‰æ‹©"å®‰å…¨ç»„"
4. æ·»åŠ å…¥æ–¹å‘è§„åˆ™ï¼š
   - åè®®ï¼šTCPï¼Œç«¯å£ï¼š80ï¼Œæºåœ°å€ï¼š0.0.0.0/0
   - åè®®ï¼šTCPï¼Œç«¯å£ï¼š443ï¼Œæºåœ°å€ï¼š0.0.0.0/0
   - åè®®ï¼šTCPï¼Œç«¯å£ï¼š22ï¼Œæºåœ°å€ï¼šæ‚¨çš„IP

### Vultr

1. ç™»å½•Vultræ§åˆ¶å°
2. è¿›å…¥"Firewall"
3. åˆ›å»ºé˜²ç«å¢™è§„åˆ™ï¼š
   - HTTPï¼šç«¯å£80ï¼Œåè®®TCP
   - HTTPSï¼šç«¯å£443ï¼Œåè®®TCP
   - SSHï¼šç«¯å£22ï¼Œåè®®TCP

### DigitalOcean

1. ç™»å½•DigitalOceanæ§åˆ¶å°
2. è¿›å…¥"Networking" > "Firewalls"
3. åˆ›å»ºé˜²ç«å¢™è§„åˆ™ï¼š
   - HTTPï¼šç«¯å£80ï¼Œåè®®TCP
   - HTTPSï¼šç«¯å£443ï¼Œåè®®TCP
   - SSHï¼šç«¯å£22ï¼Œåè®®TCP

## ğŸ” ç«¯å£æ£€æŸ¥

### æ£€æŸ¥ç«¯å£ç›‘å¬çŠ¶æ€

```bash
# æ£€æŸ¥æ‰€æœ‰ç›‘å¬ç«¯å£
ss -tlnp

# æ£€æŸ¥ç‰¹å®šç«¯å£
ss -tlnp | grep :80
ss -tlnp | grep :443
ss -tlnp | grep :8000
```

### æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€

```bash
# UFWçŠ¶æ€
sudo ufw status

# FirewalldçŠ¶æ€
sudo firewall-cmd --list-all

# iptablesçŠ¶æ€
sudo iptables -L -n
```

### æµ‹è¯•ç«¯å£è¿é€šæ€§

```bash
# ä»å¤–éƒ¨æµ‹è¯•ç«¯å£
telnet æ‚¨çš„æœåŠ¡å™¨IP 80
telnet æ‚¨çš„æœåŠ¡å™¨IP 443

# ä½¿ç”¨ncæµ‹è¯•
nc -zv æ‚¨çš„æœåŠ¡å™¨IP 80
nc -zv æ‚¨çš„æœåŠ¡å™¨IP 443
```

## ğŸŒ è®¿é—®åœ°å€

### IPv4è®¿é—®

```
http://æ‚¨çš„æœåŠ¡å™¨IPv4åœ°å€
https://æ‚¨çš„æœåŠ¡å™¨IPv4åœ°å€
```

### IPv6è®¿é—®

```
http://[æ‚¨çš„æœåŠ¡å™¨IPv6åœ°å€]
https://[æ‚¨çš„æœåŠ¡å™¨IPv6åœ°å€]
```

### APIè®¿é—®

```
http://æ‚¨çš„æœåŠ¡å™¨IP/api/v1/status
http://æ‚¨çš„æœåŠ¡å™¨IP/health
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç«¯å£æœªç›‘å¬

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status nginx
sudo systemctl status ipv6-wireguard-manager

# å¯åŠ¨æœåŠ¡
sudo systemctl start nginx
sudo systemctl start ipv6-wireguard-manager
```

#### 2. é˜²ç«å¢™é˜»æ­¢è®¿é—®

```bash
# æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
sudo ufw status
sudo firewall-cmd --list-all

# ä¸´æ—¶å…³é—­é˜²ç«å¢™æµ‹è¯•
sudo ufw disable
# æˆ–
sudo systemctl stop firewalld
```

#### 3. äº‘æœåŠ¡å•†å®‰å…¨ç»„é—®é¢˜

- æ£€æŸ¥å®‰å…¨ç»„è§„åˆ™æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æºIPåœ°å€èŒƒå›´
- éªŒè¯åè®®ç±»å‹å’Œç«¯å£å·

#### 4. ç½‘ç»œè¿æ¥é—®é¢˜

```bash
# æµ‹è¯•ç½‘ç»œè¿é€šæ€§
ping æ‚¨çš„æœåŠ¡å™¨IP

# æµ‹è¯•ç«¯å£è¿é€šæ€§
telnet æ‚¨çš„æœåŠ¡å™¨IP 80

# æ£€æŸ¥è·¯ç”±
traceroute æ‚¨çš„æœåŠ¡å™¨IP
```

### è¯Šæ–­å‘½ä»¤

```bash
# å®Œæ•´è¯Šæ–­
curl -fsSL https://raw.githubusercontent.com/ipzh/ipv6-wireguard-manager/main/check-ipv6-status.sh | bash

# è¿œç¨‹è®¿é—®æµ‹è¯•
curl -fsSL https://raw.githubusercontent.com/ipzh/ipv6-wireguard-manager/main/configure-remote-access.sh | bash
```

## ğŸ” å®‰å…¨å»ºè®®

### 1. æœ€å°æƒé™åŸåˆ™

- åªå¼€æ”¾å¿…è¦çš„ç«¯å£
- é™åˆ¶SSHè®¿é—®æºIP
- ä½¿ç”¨éæ ‡å‡†ç«¯å£ï¼ˆå¯é€‰ï¼‰

### 2. åŠ å¯†ä¼ è¾“

```bash
# é…ç½®HTTPSï¼ˆæ¨èï¼‰
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d æ‚¨çš„åŸŸå
```

### 3. å®šæœŸæ›´æ–°

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade

# æ›´æ–°åº”ç”¨
./manage.sh update
```

### 4. ç›‘æ§è®¿é—®

```bash
# æŸ¥çœ‹è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/access.log

# æŸ¥çœ‹è¿æ¥çŠ¶æ€
ss -tuln
```

## ğŸ“Š ç«¯å£ä½¿ç”¨è¯´æ˜

### ç«¯å£80 (HTTP)
- **ç”¨é€”**: å‰ç«¯Webç•Œé¢è®¿é—®
- **å¿…éœ€**: æ˜¯
- **å®‰å…¨**: å»ºè®®é…ç½®HTTPS

### ç«¯å£443 (HTTPS)
- **ç”¨é€”**: åŠ å¯†Webè®¿é—®
- **å¿…éœ€**: æ¨è
- **å®‰å…¨**: é«˜

### ç«¯å£22 (SSH)
- **ç”¨é€”**: æœåŠ¡å™¨ç®¡ç†
- **å¿…éœ€**: æ˜¯
- **å®‰å…¨**: é™åˆ¶è®¿é—®æºIP

### ç«¯å£8000 (API)
- **ç”¨é€”**: åç«¯APIç›´æ¥è®¿é—®
- **å¿…éœ€**: å¦ï¼ˆé€šè¿‡Nginxä»£ç†ï¼‰
- **å®‰å…¨**: é€šå¸¸ä¸éœ€è¦å¼€æ”¾

## ğŸ¯ æœ€ä½³å®è·µ

### 1. åˆ†å±‚é˜²æŠ¤

- äº‘æœåŠ¡å•†å®‰å…¨ç»„ï¼ˆç¬¬ä¸€å±‚ï¼‰
- ç³»ç»Ÿé˜²ç«å¢™ï¼ˆç¬¬äºŒå±‚ï¼‰
- åº”ç”¨å±‚å®‰å…¨ï¼ˆç¬¬ä¸‰å±‚ï¼‰

### 2. ç›‘æ§å’Œæ—¥å¿—

- å¯ç”¨è®¿é—®æ—¥å¿—
- ç›‘æ§å¼‚å¸¸è¿æ¥
- å®šæœŸæ£€æŸ¥å®‰å…¨çŠ¶æ€

### 3. å¤‡ä»½å’Œæ¢å¤

- å®šæœŸå¤‡ä»½é…ç½®
- æµ‹è¯•æ¢å¤æµç¨‹
- æ–‡æ¡£åŒ–é…ç½®å˜æ›´

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### å®‰è£…åæ£€æŸ¥

- [ ] æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] ç«¯å£æ­£ç¡®ç›‘å¬
- [ ] é˜²ç«å¢™è§„åˆ™é…ç½®
- [ ] äº‘æœåŠ¡å•†å®‰å…¨ç»„è®¾ç½®
- [ ] è¿œç¨‹è®¿é—®æµ‹è¯•
- [ ] æ—¥å¿—è®°å½•æ­£å¸¸

### å®šæœŸç»´æŠ¤

- [ ] æ£€æŸ¥ç«¯å£çŠ¶æ€
- [ ] æ›´æ–°é˜²ç«å¢™è§„åˆ™
- [ ] ç›‘æ§è®¿é—®æ—¥å¿—
- [ ] æµ‹è¯•è¿œç¨‹è®¿é—®
- [ ] æ›´æ–°å®‰å…¨é…ç½®

## ğŸ†˜ è·å–å¸®åŠ©

### åœ¨çº¿èµ„æº

- **GitHubä»“åº“**: https://github.com/ipzh/ipv6-wireguard-manager
- **é—®é¢˜æŠ¥å‘Š**: https://github.com/ipzh/ipv6-wireguard-manager/issues

### æœ¬åœ°å¸®åŠ©

```bash
# æŸ¥çœ‹ç®¡ç†è„šæœ¬å¸®åŠ©
./manage.sh help

# è¿è¡Œå¥åº·æ£€æŸ¥
./manage.sh health

# æŸ¥çœ‹è®¿é—®åœ°å€
./manage.sh access
```

### ç´§æ€¥ä¿®å¤

```bash
# å¿«é€Ÿä¿®å¤è®¿é—®é—®é¢˜
curl -fsSL https://raw.githubusercontent.com/ipzh/ipv6-wireguard-manager/main/configure-remote-access.sh | bash
```

## ğŸ“ æ€»ç»“

é…ç½®è¿œç¨‹è®¿é—®éœ€è¦ï¼š

1. **å¼€æ”¾å¿…è¦ç«¯å£** (80, 443, 22)
2. **é…ç½®ç³»ç»Ÿé˜²ç«å¢™** (UFW/Firewalld/iptables)
3. **è®¾ç½®äº‘æœåŠ¡å•†å®‰å…¨ç»„**
4. **æµ‹è¯•è¿œç¨‹è®¿é—®**
5. **ç›‘æ§å’Œç»´æŠ¤**

ä½¿ç”¨æä¾›çš„é…ç½®è„šæœ¬å¯ä»¥è‡ªåŠ¨åŒ–å¤§éƒ¨åˆ†é…ç½®è¿‡ç¨‹ï¼Œç¡®ä¿IPv6 WireGuard Managerèƒ½å¤Ÿæ­£å¸¸è¿œç¨‹è®¿é—®ã€‚
