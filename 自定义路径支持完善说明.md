# è‡ªå®šä¹‰è·¯å¾„æ”¯æŒå®Œå–„è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

**æ—¥æœŸ**: 2024-11-01  
**é—®é¢˜**: éªŒè¯å¹¶å®Œå–„è‡ªå®šä¹‰è·¯å¾„æ”¯æŒ  
**çŠ¶æ€**: âœ… **å·²å®Œå–„**

---

## âœ… å·²æ”¯æŒçš„è‡ªå®šä¹‰è·¯å¾„

å®‰è£…è„šæœ¬æ”¯æŒé€šè¿‡å‘½ä»¤è¡Œå‚æ•°è‡ªå®šä¹‰ä»¥ä¸‹è·¯å¾„ï¼š

### 1. å‰ç«¯ç›®å½• (`--frontend-dir`)
```bash
./install.sh --frontend-dir /var/www/myapp
```

### 2. å®‰è£…ç›®å½• (`--dir`)
```bash
./install.sh --dir /opt/custom-path
```

### 3. WireGuardé…ç½®ç›®å½• (`--config-dir`)
```bash
./install.sh --config-dir /etc/custom-wireguard
```

### 4. æ—¥å¿—ç›®å½• (`--log-dir`)
```bash
./install.sh --log-dir /var/log/custom-logs
```

### 5. Nginxé…ç½®ç›®å½• (`--nginx-dir`)
```bash
./install.sh --nginx-dir /etc/nginx/custom-sites
```

### 6. SystemdæœåŠ¡ç›®å½• (`--systemd-dir`)
```bash
./install.sh --systemd-dir /etc/systemd/custom-system
```

---

## ğŸ”§ ä¿®å¤çš„é—®é¢˜

### é—®é¢˜1: è°ƒç”¨é¡ºåºé—®é¢˜

**ä¿®å¤å‰**:
```bash
# å…ˆæ£€æµ‹ç³»ç»Ÿè·¯å¾„ï¼ˆä¼šè®¾ç½®é»˜è®¤å€¼ï¼‰
detect_system_paths

# åè§£æå‚æ•°ï¼ˆç”¨æˆ·è®¾ç½®ä¼šè¢«é»˜è®¤å€¼è¦†ç›–ï¼‰
parse_arguments "$@"
```

**ä¿®å¤å**:
```bash
# å…ˆè§£æå‚æ•°ï¼ˆç”¨æˆ·è‡ªå®šä¹‰è·¯å¾„ä¼˜å…ˆçº§æœ€é«˜ï¼‰
parse_arguments "$@"

# åæ£€æµ‹ç³»ç»Ÿè·¯å¾„ï¼ˆä»…è®¾ç½®æœªé€šè¿‡å‚æ•°æŒ‡å®šçš„è·¯å¾„ï¼‰
detect_system_paths
```

### é—®é¢˜2: è·¯å¾„æ£€æµ‹ä¸æ£€æŸ¥æ˜¯å¦å·²è®¾ç½®

**ä¿®å¤å‰**:
```bash
# æ€»æ˜¯è®¾ç½®é»˜è®¤å€¼ï¼Œå³ä½¿ç”¨æˆ·å·²æŒ‡å®š
if [[ -d "/var/www/html" ]]; then
    FRONTEND_DIR="/var/www/html"
fi
```

**ä¿®å¤å**:
```bash
# ä»…å½“æœªé€šè¿‡å‚æ•°è®¾ç½®æ—¶æ‰æ£€æµ‹å¹¶è®¾ç½®é»˜è®¤å€¼
if [[ -z "${FRONTEND_DIR:-}" ]]; then
    if [[ -d "/var/www/html" ]]; then
        FRONTEND_DIR="/var/www/html"
    fi
else
    log_info "ä½¿ç”¨è‡ªå®šä¹‰å‰ç«¯ç›®å½•: $FRONTEND_DIR"
fi
```

---

## ğŸ“Š è·¯å¾„ä¼˜å…ˆçº§

è·¯å¾„è®¾ç½®çš„ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š

1. **å‘½ä»¤è¡Œå‚æ•°** (`--frontend-dir`, `--dir` ç­‰)
2. **ç¯å¢ƒå˜é‡** (å¦‚æœè„šæœ¬æ”¯æŒ)
3. **ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹** (`detect_system_paths()`)
4. **ç¡¬ç¼–ç é»˜è®¤å€¼**

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: å®Œå…¨è‡ªå®šä¹‰è·¯å¾„
```bash
sudo ./install.sh \
    --frontend-dir /var/www/my-custom-app \
    --dir /opt/my-custom-install \
    --config-dir /etc/my-wireguard \
    --log-dir /var/log/my-logs \
    --nginx-dir /etc/nginx/my-sites
```

### ç¤ºä¾‹2: ä»…è‡ªå®šä¹‰å‰ç«¯ç›®å½•
```bash
sudo ./install.sh --frontend-dir /var/www/html/myapp
```

### ç¤ºä¾‹3: è‡ªå®šä¹‰å¤šä¸ªç›®å½•
```bash
sudo ./install.sh \
    --frontend-dir /var/www/html \
    --log-dir /var/log/ipv6wgm
```

### ç¤ºä¾‹4: ç”Ÿäº§ç¯å¢ƒè‡ªå®šä¹‰è·¯å¾„
```bash
sudo ./install.sh \
    --production \
    --frontend-dir /var/www/ipv6-wireguard-manager \
    --dir /opt/ipv6-wireguard-manager \
    --performance
```

---

## âœ… éªŒè¯æ¸…å•

- [x] å‘½ä»¤è¡Œå‚æ•° `--frontend-dir` å¯ä»¥è‡ªå®šä¹‰å‰ç«¯ç›®å½•
- [x] å‘½ä»¤è¡Œå‚æ•°ä¼˜å…ˆçº§é«˜äºè‡ªåŠ¨æ£€æµ‹
- [x] è‡ªåŠ¨æ£€æµ‹ä»…åœ¨æœªæŒ‡å®šæ—¶è¿è¡Œ
- [x] è‡ªå®šä¹‰è·¯å¾„ä¼šåœ¨æ—¥å¿—ä¸­æ˜¾ç¤º
- [x] Nginxé…ç½®ä½¿ç”¨è‡ªå®šä¹‰è·¯å¾„
- [x] å‰ç«¯æ–‡ä»¶å¤åˆ¶åˆ°è‡ªå®šä¹‰ç›®å½•
- [x] æƒé™è®¾ç½®åº”ç”¨åˆ°è‡ªå®šä¹‰ç›®å½•

---

## ğŸ” ä»£ç å˜æ›´

### 1. ä¿®å¤è·¯å¾„æ£€æµ‹å‡½æ•°

**æ–‡ä»¶**: `install.sh` - `detect_system_paths()`

**å˜æ›´**:
- æ·»åŠ  `if [[ -z "${FRONTEND_DIR:-}" ]]` æ£€æŸ¥
- ä»…åœ¨æœªè®¾ç½®æ—¶è¿›è¡Œè‡ªåŠ¨æ£€æµ‹
- æ·»åŠ æ—¥å¿—æ˜¾ç¤ºä½¿ç”¨çš„æ˜¯è‡ªå®šä¹‰è¿˜æ˜¯è‡ªåŠ¨æ£€æµ‹çš„è·¯å¾„

### 2. ä¿®å¤è°ƒç”¨é¡ºåº

**æ–‡ä»¶**: `install.sh` - `main()`

**å˜æ›´**:
- `parse_arguments()` åœ¨ `detect_system_paths()` ä¹‹å‰è°ƒç”¨
- ç¡®ä¿ç”¨æˆ·è‡ªå®šä¹‰è·¯å¾„ä¼˜å…ˆçº§æœ€é«˜

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **è·¯å¾„å¿…é¡»å­˜åœ¨æˆ–å¯åˆ›å»º**
   - å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œè„šæœ¬ä¼šå°è¯•åˆ›å»º
   - éœ€è¦è¶³å¤Ÿçš„æƒé™ï¼ˆé€šå¸¸éœ€è¦sudoï¼‰

2. **ç›¸å¯¹è·¯å¾„æ”¯æŒ**
   - æ”¯æŒç›¸å¯¹è·¯å¾„ï¼Œä½†ä¸æ¨è
   - å»ºè®®ä½¿ç”¨ç»å¯¹è·¯å¾„

3. **è·¯å¾„éªŒè¯**
   - è„šæœ¬ä¼šéªŒè¯è·¯å¾„æ˜¯å¦æœ‰æ•ˆ
   - å¦‚æœè·¯å¾„æ— æ•ˆï¼Œä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

4. **æƒé™è¦æ±‚**
   - è‡ªå®šä¹‰è·¯å¾„é€šå¸¸éœ€è¦sudoæƒé™
   - ç¡®ä¿è·¯å¾„çš„æ‰€æœ‰è€…å’Œæƒé™è®¾ç½®æ­£ç¡®

---

## ğŸš€ æµ‹è¯•å»ºè®®

### æµ‹è¯•1: è‡ªå®šä¹‰å‰ç«¯ç›®å½•
```bash
# ä½¿ç”¨è‡ªå®šä¹‰è·¯å¾„å®‰è£…
sudo ./install.sh --frontend-dir /var/www/myapp

# éªŒè¯æ–‡ä»¶æ˜¯å¦å¤åˆ¶åˆ°è‡ªå®šä¹‰ç›®å½•
ls -la /var/www/myapp/index.php
```

### æµ‹è¯•2: éªŒè¯Nginxé…ç½®
```bash
# æ£€æŸ¥Nginxé…ç½®æ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰è·¯å¾„
grep "root" /etc/nginx/sites-available/ipv6-wireguard-manager
```

### æµ‹è¯•3: å®Œæ•´è‡ªå®šä¹‰è·¯å¾„
```bash
# æµ‹è¯•æ‰€æœ‰è‡ªå®šä¹‰è·¯å¾„
sudo ./install.sh \
    --frontend-dir /var/www/custom \
    --dir /opt/custom \
    --log-dir /var/log/custom

# éªŒè¯æ‰€æœ‰è·¯å¾„éƒ½å·²åº”ç”¨
```

---

**å®Œå–„å®Œæˆæ—¶é—´**: 2024-11-01  
**ç‰ˆæœ¬**: v3.1.3-fixed  
**çŠ¶æ€**: âœ… å·²å®Œå–„ï¼Œæ”¯æŒå®Œå…¨è‡ªå®šä¹‰è·¯å¾„

